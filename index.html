<!DOCTYPE html>
<html lang="no">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Feiring av Eilin Valencia</title>
    <style>

        
        body {
            font-family: Arial, sans-serif;
            background: linear-gradient(to bottom, #3a506b, #5c677d);
            color: white;
            text-align: center;
            padding: 20px;
        }
        h1 {
            color: silver;
            font-size: 2.5em;
        }
        .content-container {
            display: flex;
            flex-direction: column;
            align-items: center;
        }
        .main-image {
            width: 90%;
            max-width: 600px;
            border-radius: 10px;
            box-shadow: 0px 0px 10px rgba(255, 255, 255, 0.5);
            margin-bottom: 20px;
        }
        .schedule-container {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin-top: 20px;
        }
        .schedule {
            background: rgba(255, 255, 255, 0.2);
            padding: 20px;
            border-radius: 10px;
            width: 300px;
        }
        .schedule-frame {
            padding: 20px;
            border: 5px solid pink;
            border-radius: 15px;
            background: rgba(255, 255, 255, 0.1);
        }
        .attendance-container {
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 50px;
            margin-top: 20px;
        }
        .update-wheel-container {
            display: flex;
            justify-content: center;
            gap: 50px;
            margin-top: 30px;
        }
        .update-container, .wheel-container {
            padding: 20px;
            background: rgba(255, 255, 255, 0.2);
            border-radius: 10px;
            width: 300px;
            text-align: center;
        }
        .wheel-container canvas {
            margin-top: 10px;
            border-radius: 50%;
            background: white;
        }
        .wheel-container {
            position: relative; /* S√∏rger for at pilen plasseres i forhold til denne */
        }

        .arrow {
            width: 0;
            height: 0;
            border-left: 15px solid transparent;
            border-right: 15px solid transparent;
            border-top: 30px solid red; /* R√∏d pil */
            position: absolute;
            top: 80px;
            left: 50%;
            transform: translateX(-50%);
            z-index: 10;
        }
/* üì± Gj√∏r nettsiden mobilvennlig */
@media (max-width: 768px) {
    body {
        padding: 10px;
    }
    
    .content-container {
        flex-direction: column; /* Endrer layout fra rad til kolonne */
        align-items: center;
    }

    .schedule-container {
        flex-direction: column; /* Stabler skjemaene vertikalt */
        width: 100%;
    }

    .schedule {
        width: 90%; /* Gj√∏r boksene bredere p√• mobil */
        margin-bottom: 10px;
    }

    .attendance-container {
        flex-direction: column; /* Gj√∏r "Meld deg p√•"-seksjonen mer mobilvennlig */
        gap: 20px;
    }

    .wheel-container {
        width: 100%; /* S√∏rger for at lykkehjulet ikke blir for stort */
    }

    canvas {
        width: 100%; /* Gj√∏r lykkehjulet mindre p√• mobil */
        height: auto;
    }

    .arrow {
        top: 5px; /* Justerer pilen for mobilvisning */
    }

    input, button {
        width: 90%; /* Gj√∏r inputfeltene og knappene lettere √• bruke */
        font-size: 16px; /* √òker tekstst√∏rrelsen for bedre lesbarhet */
    }
        .update-wheel-container {
        flex-direction: column; /* Stabler elementene vertikalt */
        align-items: center;
        gap: 20px;
    }

    .update-container, .wheel-container {
        width: 90%; /* Gj√∏r boksene bredere */
        max-width: 400px; /* Hindrer at de blir for brede */
    }

    .wheel-container canvas {
        width: 90vw; /* Gj√∏r lykkehjulet mer mobilvennlig */
        height: auto;
        max-width: 300px; /* Hindrer at det blir for stort */
    }

    .arrow {
        top: 80px; /* Flytter pilen n√¶rmere hjulet */
        left: 50%;
        transform: translateX(-50%);
        border-bottom-width: 20px; /* Gj√∏r pilen st√∏rre */
    }

    .wheel-container button {
        width: 80%; /* Gj√∏r knappen mer mobilvennlig */
        margin-top: 10px;
    }

      .wheel-container {
        position: relative;
    }

    .winner-name {
        position: absolute;
        top: 50%;  /* Plasserer teksten midt p√• hjulet */
        left: 50%;
        transform: translate(-50%, -50%);
        font-size: 20px; /* St√∏rre skrift p√• mobil */
        font-weight: bold;
        color: black; /* S√∏rg for at teksten er synlig */
        background: rgba(255, 255, 255, 0.8); /* Bakgrunn for lesbarhet */
        padding: 5px;
        border-radius: 5px;
        text-align: center;
    }

}
        
    </style>
</head>
<body>
    <h1>Feiring av Eilin Valencia</h1>
    <img class="main-image" src="IMG_6316.jpg" alt="ait">
    <div class="content-container">
    <h2>DAGSFYLLA!!!</h2>  
        <div class="schedule-container schedule-frame">
            <div class="schedule">
                <h2>L√∏rdag</h2>
                <p>16:00 - Velkomst til vors</p>
                <p>17:30 - Noe s√∏tt p√• tungen</p>
                <p>19:00 - √òlbong championship (kanskje noen p√• 21 √•r blir icet)</p>
                <p>20:00 - Nystemten</p>
                <p>20:30 - Avreise fra vors</p>
                <p>21:20 - Konsertstart</p>
            </div>
            
            <div class="schedule">
                <h2>S√∏ndag</h2>
                <p>10:00 ish - frokostVors, vi stiller med rundstykker og p√•legg</p>
                <p>13:00 - Avreise til solsiden</p>
                <p>14:00 - Cava herifra til helvete</p>
            </div>
        </div>
        
        <div class="attendance-container">
            <div class="image-container">
                <img src="IMG_6184.jpg" alt="pikk" style="width: 180px; border-radius: 10px;">
            </div>
            
            <div class="attendance">
                <h2>Meld deg p√•/av</h2>
                <input type="text" id="name" placeholder="Ditt navn">
                <button id="signupButton">Meld deg p√•</button>
                <button id="signOffButton">Meld deg av</button>
                <h3>Disse kommer:</h3>
                <ul id="attendees"></ul>
            </div>
            
            <div class="image-container">
                <img src="IMG_6307.jpg" alt="fitte" style="width: 180px; border-radius: 10px;">
            </div>
        </div>

        <div class="update-wheel-container">
            <div class="update-container">
                <h2>Er litt tekniske problemer med nettsiden per n√•</h2>
                <p>-knappen for √• melde seg p√• er fortsatt under bygging, takk for t√•lmodigheten</p>
            </div>
            <div class="wheel-container">
                <h2>Hvem skal ices?</h2>
                <div class="arrow"></div>
                <canvas id="wheelCanvas" width="300" height="300"></canvas>
                <button onclick="spinWheel()">Spinn lykkehjulet</button>
            </div>
        </div>
    </div>

    <script>
        let attendees = [];
        let spinning = false;
        let angle = 0;
        let spinSpeed = 20;
        
        function signUp() {
            let name = document.getElementById('name').value;
            if (name && !attendees.includes(name)) {
                attendees.push(name);
                updateList();
            }
        }

        function signOff() {
            let name = document.getElementById('name').value;
            attendees = attendees.filter(person => person !== name);
            updateList();
        }

        function updateList() {
            let list = document.getElementById('attendees');
            list.innerHTML = '';
            attendees.forEach(person => {
                let li = document.createElement('li');
                li.textContent = person;
                list.appendChild(li);
            });
            drawWheel();
        }

        function drawWheel() {
            let canvas = document.getElementById("wheelCanvas");
            let ctx = canvas.getContext("2d");
            let totalSlices = attendees.length;
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            
            if (totalSlices === 0) return;

            let startAngle = angle;
            let sliceAngle = (Math.PI * 2) / totalSlices;

            for (let i = 0; i < totalSlices; i++) {
                // Tegner segmentene
                ctx.beginPath();
                ctx.moveTo(150, 150);
                ctx.arc(150, 150, 140, startAngle, startAngle + sliceAngle);
                ctx.fillStyle = `hsl(${i * (360 / totalSlices)}, 100%, 70%)`;
                ctx.fill();
                ctx.stroke();
                
                // Legger til navnene i hvert segment
                ctx.save();
                ctx.translate(150, 150);
                ctx.rotate(startAngle + sliceAngle / 2);
                ctx.textAlign = "right";
                ctx.fillStyle = "black"; // S√∏rger for at teksten er synlig
                ctx.font = "16px Arial";
                ctx.fillText(attendees[i], 120, 5);
                ctx.restore();
                
                startAngle += sliceAngle;
            }
        }


        function spinWheel() {
            if (spinning || attendees.length === 0) return;
            spinning = true;
            let interval = setInterval(() => {
                angle += spinSpeed;
                spinSpeed *= 0.98;
                drawWheel();
                if (spinSpeed < 0.5) {
                    clearInterval(interval);
                    spinning = false;
                    spinSpeed = 20;
                    alert(attendees[Math.floor(Math.random() * attendees.length)] + " skal ices!");
                }
            }, 50);
        }
        function selectWinner() {
            let segmentAngle = (2 * Math.PI) / attendees.length;
            let selectedIndex = Math.floor(((angle % (2 * Math.PI)) / segmentAngle) + attendees.length) % attendees.length;
            let winner = attendees[selectedIndex];
        
            // üî• Legger til vinnernavn i HTML p√• mobil og PC
            let winnerDisplay = document.getElementById("winner-display");
        
            if (!winnerDisplay) { // Oppretter elementet hvis det ikke finnes
                winnerDisplay = document.createElement("div");
                winnerDisplay.id = "winner-display";
                winnerDisplay.className = "winner-name";
                document.querySelector(".wheel-container").appendChild(winnerDisplay);
            }
        
            // üí° S√∏rger for at teksten oppdateres riktig hver gang
            winnerDisplay.textContent = winner + " skal ices!";
        }

    </script>
 <script type="module">
  // üî• Firebase-setup
import { initializeApp } from "https://www.gstatic.com/firebasejs/11.3.1/firebase-app.js";
import { getDatabase, ref, push, remove, onChildAdded, onChildRemoved, onValue } from "https://www.gstatic.com/firebasejs/11.3.1/firebase-database.js";

const firebaseConfig = {
    apiKey: "AIzaSyBUCYeED-SyhEirXS3vztm4M2y3ayoJx-E",
    authDomain: "eilin-feiring.firebaseapp.com",
    databaseURL: "https://eilin-feiring-default-rtdb.firebaseio.com",
    projectId: "eilin-feiring",
    storageBucket: "eilin-feiring.appspot.com",
    messagingSenderId: "193956821224",
    appId: "1:193956821224:web:aa146fd6303dc82d46b15d",
    measurementId: "G-WEE1GXTJVN"
};

const app = initializeApp(firebaseConfig);
const database = getDatabase(app);
const attendeesRef = ref(database, "attendees");

let attendees = []; // Global liste for lykkehjulet
let rotationAngle = 0; // Holder styr p√• vinkelen
let spinSpeed = 0; // Hastighet p√• spinning

function drawWheel(rotation = 0) {
    let canvas = document.getElementById("wheelCanvas");
    let ctx = canvas.getContext("2d");
    let totalSlices = attendees.length;

    ctx.clearRect(0, 0, canvas.width, canvas.height);

    if (totalSlices === 0) return;

    let sliceAngle = (2 * Math.PI) / totalSlices;

    ctx.save();
    ctx.translate(150, 150); // Flytter tegningen til midten av canvas
    ctx.rotate(rotation); // Roterer hele hjulet

    for (let i = 0; i < totalSlices; i++) {
        ctx.beginPath();
        ctx.moveTo(0, 0);
        ctx.arc(0, 0, 140, i * sliceAngle, (i + 1) * sliceAngle);
        ctx.fillStyle = `hsl(${i * (360 / totalSlices)}, 100%, 70%)`;
        ctx.fill();
        ctx.stroke();

        // Legg til navn i segmentene
        ctx.save();
        ctx.rotate(sliceAngle / 2);
        ctx.textAlign = "right";
        ctx.fillStyle = "black";
        ctx.font = "14px Arial";
        ctx.fillText(attendees[i], 120, 5);
        ctx.restore();

        ctx.rotate(sliceAngle);
    }

    ctx.restore();
}

function spinWheel() {
    if (attendees.length === 0) {
        alert("Ingen deltakere p√• lykkehjulet!");
        return;
    }

    spinSpeed = Math.random() * 10 + 20; // Startfart
    let friction = 0.98; // Hvor raskt hjulet bremser

    function animate() {
        if (spinSpeed > 0.2) { // Fortsett √• spinne til hastigheten er lav nok
            spinSpeed *= friction; // Reduser hastigheten gradvis
            rotationAngle += spinSpeed * (Math.PI / 180); // Oppdater vinkelen
            drawWheel(rotationAngle); // Oppdater hjulet

            requestAnimationFrame(animate); // Kj√∏r neste animasjon frame
        } else {
            // üî• N√•r hjulet stopper, finn vinneren
            let segmentAngle = (2 * Math.PI) / attendees.length;
            let selectedIndex = Math.floor((rotationAngle % (2 * Math.PI)) / segmentAngle);
            let winner = attendees[selectedIndex];

            setTimeout(() => {
                alert(winner + " skal ices! üßä");
            }, 500);
        }
    }

    animate(); // Start animasjonen
}

// üî• 2Ô∏è‚É£ Firebase: Oppdater hjulet n√•r noen melder seg p√•/av
onValue(attendeesRef, (snapshot) => {
    let list = document.getElementById('attendees');
    list.innerHTML = "";
    attendees = [];

    if (!snapshot.exists()) {
        console.log("üìå Ingen p√•meldinger funnet.");
        drawWheel();
        return;
    }

    snapshot.forEach(childSnapshot => {
        let name = childSnapshot.val().navn;
        if (!attendees.includes(name)) {
            attendees.push(name);
        }

        let li = document.createElement('li');
        li.textContent = name;
        list.appendChild(li);
    });

    drawWheel(); // Tegner hjulet p√• nytt basert p√• Firebase-deltakere
});

// üî• 3Ô∏è‚É£ Funksjon for √• spinne hjulet (denne fikser animasjonen)
function spinWheel() {
    if (spinning || attendees.length === 0) {
        alert("Ingen deltakere p√• lykkehjulet!");
        return;
    }
    
    spinning = true;
    spinSpeed = Math.random() * 10 + 30; // Startfart
    let friction = 0.98; // Hvor raskt det bremser

    function animate() {
        if (spinSpeed > 0.2) { // Fortsett √• spinne til hastigheten er lav nok
            spinSpeed *= friction; // Reduser hastigheten gradvis
            rotationAngle += spinSpeed * (Math.PI / 180); // Oppdater vinkelen
            drawWheel(rotationAngle); // Oppdater hjulet

            requestAnimationFrame(animate); // Kj√∏r neste animasjon frame
        } else {
            spinning = false;
            // üî• N√•r hjulet stopper, finn vinneren
            let segmentAngle = (2 * Math.PI) / attendees.length;
            let selectedIndex = Math.floor((rotationAngle % (2 * Math.PI)) / segmentAngle);
            let winner = attendees[selectedIndex];

            setTimeout(() => {
                alert(winner + " skal ices! üßä");
            }, 500);
        }
    }

    animate(); // Start animasjonen
}

// üî• 4Ô∏è‚É£ Funksjon for √• melde seg p√•
async function signUp() {
    let name = document.getElementById('name').value.trim();
    if (name) {
        console.log("Pr√∏ver √• lagre:", name);
        try {
            await push(attendeesRef, { navn: name, timestamp: Date.now() });
            console.log("‚úÖ Data lagret i Firebase!");
            document.getElementById('name').value = "";
        } catch (error) {
            console.error("‚ùå Feil ved lagring:", error);
        }
    } else {
        alert("Vennligst skriv inn et navn!");
    }
}

// üî• 5Ô∏è‚É£ Funksjon for √• melde seg av
async function signOff() {
    let name = document.getElementById('name').value.trim();
    if (!name) {
        alert("Vennligst skriv inn navnet ditt for √• melde deg av.");
        return;
    }

    onValue(attendeesRef, (snapshot) => {
        snapshot.forEach(childSnapshot => {
            if (childSnapshot.val().navn === name) {
                remove(ref(database, `attendees/${childSnapshot.key}`));
                console.log(`‚úÖ ${name} er n√• meldt av.`);
            }
        });

        document.getElementById('name').value = "";
    }, { onlyOnce: true });
}

// üî• 6Ô∏è‚É£ Koble knapper til funksjonene
document.getElementById('signupButton').addEventListener('click', signUp);
document.getElementById('signOffButton').addEventListener('click', signOff);


</script>

</body>
</html>
